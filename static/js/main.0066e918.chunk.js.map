{"version":3,"sources":["App.js","reportWebVitals.js","index.js"],"names":["sitePrefix","App","state","readyState","shouldUpdateTable","fetch","headers","then","res","json","data","locationDictionary","locsShorthand","i","length","setState","axios","get","statusData","lastWebsiteUpdateTime","Date","this","now","date","fetchJsonFiles","console","log","statusVal","available","statuses","locEntry","locDetails","push","getCard","lastRescrapeRenderTime","parse","status","lastUpdateTimeTextVal","apptTextVal","secondsAgo","Math","floor","minutesAgo","hoursAgo","lastUpdateTimeText","apptText","timerID","setInterval","updateDataAndState","clearInterval","className","style","fontSize","color","index","name","details","url","Card","width","marginLeft","marginRight","marginBottom","Body","Title","fontWeight","Text","lineHeight","split","map","item","Button","variant","target","href","React","Component","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.0066e918.chunk.js","sourcesContent":["import React from 'react';\nimport './App.css';\nimport Card from 'react-bootstrap/Card';\nimport Button from 'react-bootstrap/Button';\nimport axios from 'axios';\n\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nconst sitePrefix = \"https://wa-vaccine.xvm.mit.edu:3075\"\n\nclass App extends React.Component {\n\n  constructor() {\n    super();\n    \n    this.state = ({\n      readyState: 0,\n      shouldUpdateTable: true\n    });\n  }\n\n  fetchJsonFiles() {\n    fetch(sitePrefix + '/api/locations', {headers: {'Access-Control-Allow-Origin': '*'}})\n    .then( res => res.json())\n    .then(data => {\n      var locationDictionary = {};\n\n      var locationsData = data;\n\n      var locsShorthand = locationsData[\"locations\"];\n      for(var i = 0; i < locsShorthand.length; i++) {\n        var id = locsShorthand[i][\"name\"] + \" \" + locsShorthand[i][\"url\"] + \" \" + locsShorthand[i][\"address\"] + \" \" + locsShorthand[i][\"city\"] + \" \" + locsShorthand[i][\"county\"];\n        locationDictionary[id] = locsShorthand[i];\n      }\n      this.setState({\n        locationDictionary: locationDictionary,\n        readyState: this.state.readyState + 1\n      });\n    });\n    axios.get(sitePrefix + \"/api/statuses\", {headers: {'Access-Control-Allow-Origin': '*'}})\n    .then((res) => {\n      this.setState({\n        statusData: res.data,\n        readyState: this.state.readyState + 1\n      });\n    });\n\n    axios.get(sitePrefix + \"/api/last_update\", {headers: {'Access-Control-Allow-Origin': '*'}})\n    .then((res) => {\n      this.setState({\n        lastWebsiteUpdateTime: new Date(res.data[\"time\"]),\n        readyState: this.state.readyState + 1\n      });\n    });\n  }\n\n  updateDataAndState() {\n    if(this.state.readyState !== 3) {\n      return;\n    }\n\n    var now = new Date();\n\n    axios.get(sitePrefix + \"/api/last_update\", {headers: {'Access-Control-Allow-Origin': '*'}})\n      .then((res) => {\n        var date = new Date(res.data[\"time\"]);\n        // console.log(\"COMPARE \" + (date - this.state.lastWebsiteUpdateTime) + \" \" + date);\n        if(date - this.state.lastWebsiteUpdateTime !== 0) {\n          this.setState({\n            readyState: 0,\n            shouldUpdateTable: true,\n            lastWebsiteUpdateTime: date\n          });\n          this.fetchJsonFiles();\n        }\n      });\n\n    if(this.state.shouldUpdateTable) {\n      console.log(\"UPDATE TABLE\");\n      var statusVal = [];\n\n      this.setState({\n        available: 0\n      });\n      var statuses = this.state.statusData[\"statuses\"];\n      for(var i = 0; i < statuses.length; i++) {\n        var data = statuses[i][\"serialized\"];\n\n        if(data[\"availability\"] === \"AVAILABLE\") {\n          this.setState({\n            available: this.state.available + 1\n          });\n\n          var locEntry = this.state.locationDictionary[statuses[i][\"loc\"]];\n          var locDetails = locEntry[\"county\"] + \"\\n\" + (locEntry[\"address\"] === \"\" ? locEntry[\"city\"] : locEntry[\"address\"]) + \"\\n\" + locEntry[\"phoneNumber\"] + \"\\n\" + locEntry[\"email\"];\n\n          statusVal.push(this.getCard(i + 1, locEntry[\"name\"], locDetails, data[\"currentUrl\"]));\n        }\n      }\n\n      this.setState({\n          lastRescrapeRenderTime: Date.parse(this.state.lastWebsiteUpdateTime),\n          status: statusVal,\n          shouldUpdateTable: false\n      });\n    }\n\n    var secondsAgo = Math.floor((now - this.state.lastWebsiteUpdateTime) / 1000);\n    var minutesAgo = Math.floor(secondsAgo / 60);\n    var hoursAgo = Math.floor(minutesAgo / 60);\n\n    var lastUpdateTimeTextVal;\n    if(secondsAgo < 60) {\n      lastUpdateTimeTextVal = \"Last updated \" + secondsAgo + \" second\" + (secondsAgo === 1 ? \"\" : \"s\") + \" ago\"\n    } else if(minutesAgo < 60) {\n      lastUpdateTimeTextVal = \"Last updated \" + minutesAgo + \" minute\" + (minutesAgo === 1 ? \"\" : \"s\") + \" ago\"\n    } else {\n      lastUpdateTimeTextVal = \"Last updated \" + hoursAgo + \" hour\" + (hoursAgo === 1 ? \"\" : \"s\") + \" ago\"  \n    }\n\n    var apptTextVal;\n    if(this.state.available === 0) {\n      apptTextVal = \"There are currently no locations that are accepting appointments.\"\n    } else if (this.state.available === 1) {\n      apptTextVal = \"There is currently 1 location that is accepting appointments:\";\n    } else {\n      apptTextVal = \"There are currently \" + this.state.available + \" locations that are accepting appointments:\";\n    }\n\n    this.setState({\n      lastUpdateTimeText: lastUpdateTimeTextVal,\n      apptText: apptTextVal\n    });\n  }\n\n  componentDidMount() {\n    this.fetchJsonFiles();\n\n    this.timerID = setInterval(\n      () => {\n        this.updateDataAndState();\n      }, 1000\n    );\n  }\n\n  componentWillUnmount() {\n    clearInterval(this.timerID);\n  }\n\n  render() {\n    return (\n      <div className=\"App\">\n        <header className=\"App-header\">\n          <br></br>\n          <h1 style={{fontSize: \"1.8em\"}}>\n            Where can I get the vaccine?\n          </h1>\n          <h3 style={{fontSize: \"0.7em\"}}>\n            WASHINGTON STATE\n            <br></br>\n            Currently available for ages 65 years and older.\n          </h3>\n          <br></br>\n          <p style={{fontSize: \"1em\"}}>\n            {this.state.readyState !== 3 ? \"Loading...\" : this.state.apptText}\n          </p>\n        </header>\n        <body>\n          {this.state.status}\n        </body>\n        <p style={{fontSize: \"1em\", color: \"#cccccc\"}}>\n            {this.state.lastUpdateTimeText}\n          </p>\n      </div>\n    );\n  }\n\n  getCard(index, name, details, url) {\n    return (\n      <Card style={{ width: '95%', marginLeft: \"2.5%\", marginRight: \"2.5%\", marginBottom: \"0.8rem\" }}>\n            <Card.Body>\n              <Card.Title style={{fontWeight: \"bold\"}}>{index}. {name}</Card.Title>\n              <Card.Text style={{marginLeft: \"1.5rem\", lineHeight: \"1rem\"}}>\n                {details.split(\"\\n\").map((item, i) => <p key={i}>{item}</p>)}\n              </Card.Text>\n              <Button style={{ width: '100%' }} variant=\"primary\" target=\"_blank\" href={url}>Visit site</Button>\n            </Card.Body>\n          </Card>\n    );\n  }\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}